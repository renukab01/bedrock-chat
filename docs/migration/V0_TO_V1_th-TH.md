# คู่มือการย้ายระบบ (จาก v0 เป็น v1)

หากคุณกำลังใช้ Bedrock Chat กับเวอร์ชันก่อนหน้านี้ (~`0.4.x`) คุณจำเป็นต้องทำตามขั้นตอนต่อไปนี้เพื่อย้ายระบบ

## ทำไมฉันต้องทำเช่นนี้?

การอัปเดตครั้งใหญ่นี้รวมถึงการอัปเดตด้านความปลอดภัยที่สำคัญ

- ที่เก็บฐานข้อมูลเวกเตอร์ (เช่น pgvector บน Aurora PostgreSQL) ตอนนี้ได้รับการเข้ารหัสแล้ว ซึ่งจะทำให้เกิดการแทนที่เมื่อปรับใช้ ซึ่งหมายความว่ารายการเวกเตอร์ที่มีอยู่จะถูกลบ
- เราได้แนะนำกลุ่มผู้ใช้ Cognito `CreatingBotAllowed` เพื่อจำกัดผู้ใช้ที่สามารถสร้างบอต ผู้ใช้ที่มีอยู่ในปัจจุบันจะไม่อยู่ในกลุ่มนี้ ดังนั้นคุณจำเป็นต้องแนบสิทธิ์ด้วยตนเองหากต้องการให้พวกเขามีความสามารถในการสร้างบอต ดู: [การปรับแต่งบอต](../../README.md#bot-personalization)

## ข้อกำหนดเบื้องต้น

อ่าน [คู่มือการโยกย้ายฐานข้อมูล](./DATABASE_MIGRATION_th-TH.md) และกำหนดวิธีการกู้คืนรายการ

## ขั้นตอน

### การย้ายที่เก็บเวกเตอร์

- เปิดเทอร์มินัลของคุณและนำทางไปยังไดเรกทอรีโปรเจกต์
- ดึงแขนงที่คุณต้องการปรับใช้ ต่อไปนี้คือการสลับไปยังแขนงที่ต้องการ (ในกรณีนี้คือ `v1`) และดึงการเปลี่ยนแปลงล่าสุด:

```sh
git fetch
git checkout v1
git pull origin v1
```

- หากคุณต้องการคืนค่ารายการด้วย DMS ห้ามลืมปิดการหมุนรหัสผ่านและจดบันทึกรหัสผ่านเพื่อเข้าถึงฐานข้อมูล หากคืนค่าด้วยสคริปต์การย้าย([migrate_v0_v1.py](./migrate_v0_v1.py)) คุณไม่จำเป็นต้องจดบันทึกรหัสผ่าน
- ลบ[API ที่เผยแพร่](../PUBLISH_API_th-TH.md) ทั้งหมดเพื่อให้ CloudFormation สามารถลบคลัสเตอร์ Aurora ที่มีอยู่
- เรียกใช้ [npx cdk deploy](../README.md#deploy-using-cdk) เพื่อแทนที่คลัสเตอร์ Aurora และ ลบรายการเวกเตอร์ทั้งหมด
- ทำตาม[คู่มือการย้ายฐานข้อมูล](./DATABASE_MIGRATION_th-TH.md) เพื่อคืนค่ารายการเวกเตอร์
- ตรวจสอบว่าผู้ใช้สามารถใช้บอทที่มีอยู่ซึ่งมีความรู้ เช่น บอท RAG

### แนบสิทธิ์ CreatingBotAllowed

- หลังจากการปรับใช้ ผู้ใช้ทั้งหมดจะไม่สามารถสร้างบอทใหม่ได้
- หากคุณต้องการให้ผู้ใช้เฉพาะรายสามารถสร้างบอทได้ ให้เพิ่มผู้ใช้เหล่านั้นในกลุ่ม `CreatingBotAllowed` โดยใช้คอนโซลการจัดการหรือ CLI
- ตรวจสอบว่าผู้ใช้สามารถสร้างบอทได้ โปรดทราบว่าผู้ใช้จำเป็นต้องเข้าสู่ระบบใหม่